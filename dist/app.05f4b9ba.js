(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,function(t,e,o){},function(t,e,o){},function(t,e,o){},function(t,e,o){},function(t,e,o){},function(t,e,o){},function(t,e,o){},function(t,e,o){},function(t,e,o){},,,,,,,,,,,function(t,e,o){"use strict";var s=o(6);o.n(s).a},function(t,e,o){"use strict";var s=o(7);o.n(s).a},function(t,e,o){"use strict";var s=o(8);o.n(s).a},,,,,,,,,,,,,,,,,,,function(t,e,o){"use strict";var s=o(9);o.n(s).a},function(t,e,o){"use strict";var s=o(10);o.n(s).a},function(t,e,o){"use strict";var s=o(11);o.n(s).a},function(t,e,o){"use strict";var s=o(12);o.n(s).a},function(t,e,o){"use strict";var s=o(13);o.n(s).a},,,function(t,e,o){"use strict";var s=o(14);o.n(s).a},function(t,e,o){},function(t,e,o){"use strict";o.r(e);var s={};o.r(s),o.d(s,"count",function(){return g}),o.d(s,"todos",function(){return E}),o.d(s,"loadingVisible",function(){return y});var i={};o.r(i),o.d(i,"setCountAsync",function(){return O}),o.d(i,"getTodosAsync",function(){return A}),o.d(i,"deleteTodoAsync",function(){return w}),o.d(i,"addTodoAsync",function(){return D}),o.d(i,"updateTodoAsync",function(){return x}),o.d(i,"deleteCompletedAsync",function(){return $});var n=o(3),a=o(15),r=o(1),l=o(23),d=o.n(l),c={},u=(o(25),o(0)),m=Object(u.a)(c,function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"header"},[e("router-link",{staticClass:"link todo",attrs:{to:"/todo"}},[this._v("\n      首页\n    ")]),this._v(" "),e("router-link",{staticClass:"link login",attrs:{to:"/login"}},[this._v("\n      登录\n    ")])],1),this._v(" "),this._m(0)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("header",{staticClass:"main-header"},[e("h1",[this._v("Next to do")])])}],!1,null,null,null).exports,p={data:()=>({author:"bjw"})},f=(o(26),Object(u.a)(p,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"footer"}},[e("span",[this._v("Written by "+this._s(this.author))])])},[],!1,null,null,null).exports);var v={components:{HeaderCom:m,FooterCom:f},computed:{...Object(r.c)(["count","loadingVisible"])},methods:{addNotify(){this.$notify({autoCloseTime:3e3,content:"hello world!",btn:"close"})},...Object(r.d)({setCount:"SET_COUNT",setLoadingVisible:"SET_LOADING_VISIBLE"}),...Object(r.b)(["setCountAsync"])}},h=(o(27),Object(u.a)(v,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("loading",{attrs:{"loading-visible":t.loadingVisible}}),t._v(" "),o("div",{staticClass:"content"},[o("HeaderCom"),t._v(" "),o("transition",{attrs:{mode:"out-in",name:"fade"}},[o("keep-alive",[o("router-view")],1)],1)],1),t._v(" "),o("button",{staticClass:"add-notify",staticStyle:{float:"left"},on:{click:function(e){return e.preventDefault(),t.addNotify(e)}}},[t._v("\n    添加notification\n  ")]),t._v(" "),o("div",{staticClass:"footer"},[o("FooterCom")],1)],1)},[],!1,null,"50af66a2",null).exports);var _={count:1,todos:[],loadingVisible:!1};var T={SET_COUNT(t,e){t.count=e},SET_TODOS(t,e){t.todos=e},DELETE_TODO(t,e){let o=t.todos.findIndex(t=>t.id===e);t.todos.splice(o,1)},UPDATE_TODO(t,{id:e,flag:o}){let s=t.todos.findIndex(t=>t.id===e);t.todos[s].completed=o},ADD_TODO(t,e){t.todos.unshift(e)},SET_LOADING_VISIBLE(t,e){t.loadingVisible=e},DELETE_COMPLETED(t,e){t.todos=t.todos.filter(t=>e.every(e=>e!==t.id))}};const g=t=>t.count,E=t=>t.todos,y=t=>t.loadingVisible;var I=o(4),b=o.n(I),C={login:(t,e)=>b.a.post("/user/login",{username:t,password:e}),getAllTodos:()=>b.a.get("/api/todos"),deleteTodo:t=>b.a.delete(`/api/todo/${t}`),addTodo:t=>b.a.post("/api/todo",{content:t,completed:!1}),updateTodo:(t,e)=>b.a.put(`/api/todo/${t}`,{completed:e}),deleteCompleted:t=>b.a.post("/api/delete/completed",{ids:t})};const O=(t,e)=>{setTimeout(()=>{t.commit("SET_COUNT",e)},2e3)};function L(t,e){if(window.e=e,401===e.request.status)return t.$notify({autoCloseTime:3e3,content:"你先登录咯"}),void t.$router.replace("/login");t.$notify({autoCloseTime:3e3,content:"不知名错误."})}function S(t,e){t.$notify({autoCloseTime:3e3,content:e})}const A=async(t,{ctx:e}={})=>{try{let o=await C.getAllTodos();if(!e)return t.commit("SET_TODOS",o.reverse()),o;if(o.data.error)return S(e,o.data.data),void t.commit("SET_LOADING_VISIBLE",!1);S(e,"获取数据成功."),t.commit("SET_TODOS",o.data.data.reverse())}catch(t){console.log("在这里吗"),e&&L(e,t)}},w=async(t,{ctx:e,id:o})=>{try{t.commit("SET_LOADING_VISIBLE",!0);let s=await C.deleteTodo(o);if(s.data.error)return S(e,s.data.data),void t.commit("SET_LOADING_VISIBLE",!1);S(e,"少做一件事情."),t.commit("SET_LOADING_VISIBLE",!1),t.commit("DELETE_TODO",o)}catch(o){t.commit("SET_LOADING_VISIBLE",!1),L(e,o)}},D=async(t,{ctx:e,content:o})=>{try{t.commit("SET_LOADING_VISIBLE",!0);let s=await C.addTodo(o);if(s.data.error)return S(e,s.data.data),void t.commit("SET_LOADING_VISIBLE",!1);S(e,"你得多做一件事情咯."),t.commit("SET_LOADING_VISIBLE",!1),t.commit("ADD_TODO",s.data.data)}catch(o){t.commit("SET_LOADING_VISIBLE",!1),L(e,o)}},x=async(t,{ctx:e,id:o,flag:s})=>{try{t.commit("SET_LOADING_VISIBLE",!0);let i=await C.updateTodo(o,s);if(i.data.error)return S(e,i.data.data),void t.commit("SET_LOADING_VISIBLE",!1);S(e,"更新todo状态."),t.commit("SET_LOADING_VISIBLE",!1),t.commit("UPDATE_TODO",{id:o,flag:s})}catch(o){t.commit("SET_LOADING_VISIBLE",!1),L(e,o)}},$=async(t,{ctx:e,ids:o})=>{try{t.commit("SET_LOADING_VISIBLE",!0);let s=await C.deleteCompleted(o);if(s.data.error)return S(e,s.data.data),void t.commit("SET_LOADING_VISIBLE",!1);S(e,"删除已完成的todo."),t.commit("SET_LOADING_VISIBLE",!1),t.commit("DELETE_COMPLETED",o)}catch(o){t.commit("SET_LOADING_VISIBLE",!1),L(e,o)}};o(24);var N={props:{todo:{type:Object,required:!0}},methods:{deleteTodo(){this.$emit("del",this.todo.id)},toggleClick(t){this.$emit("toggle",t)}}},V=(o(46),Object(u.a)(N,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{class:["todo-item",t.todo.completed?"completed":""]},[o("input",{staticClass:"toggle",attrs:{type:"checkbox"},domProps:{checked:t.todo.completed},on:{click:function(e){return e.preventDefault(),t.toggleClick(t.todo)}}}),t._v(" "),o("label",[t._v(t._s(t.todo.content))]),t._v(" "),o("button",{staticClass:"destroy",on:{click:t.deleteTodo}})])},[],!1,null,null,null).exports),k={props:{filter:{type:String,required:!0},todos:{type:Array,required:!0}},data:()=>({states:["all","active","completed"]}),computed:{unfinishedTodoLength(){return this.todos.filter(t=>!t.completed).length}},methods:{toggleFilter(t){this.$emit("toggle",t)},clearAllCompleted(){this.$emit("clearAllCompleted")}}},B=(o(47),{metaInfo:{title:"Todo Page"},components:{Item:V,Tabs:Object(u.a)(k,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"helper"},[o("span",{staticClass:"left"},[t._v(t._s(t.unfinishedTodoLength)+" items left")]),t._v(" "),o("span",{staticClass:"tabs"},t._l(t.states,function(e){return o("span",{key:e,class:["state",t.filter===e?"actived":""],on:{click:function(o){return t.toggleFilter(e)}}},[t._v("\n      "+t._s(e)+"\n    ")])}),0),t._v(" "),o("span",{staticClass:"clear",on:{click:t.clearAllCompleted}},[t._v("clear Completed")])])},[],!1,null,"13bf3069",null).exports},data:()=>({filter:"all"}),computed:{filterTodos(){if("all"===this.filter)return this.todos;const t="completed"===this.filter;return this.todos.filter(e=>t===e.completed)},...Object(r.c)(["todos"])},asyncData:({store:t})=>Promise.resolve(t.dispatch("getTodosAsync")),mounted(){this.todos&&this.todos.length<1&&this.getTodosAsync({ctx:this})},methods:{addTodo(t){""!==t.target.value.trim()&&(this.addTodoAsync({ctx:this,content:t.target.value.trim()}),t.target.value="")},deleteTodo(t){this.deleteTodoAsync({ctx:this,id:t})},toggleTodo(t){this.updateTodoAsync({ctx:this,id:t.id,flag:!t.completed})},toggleFilter(t){this.filter=t},clearAllCompleted(){let t=[];this.todos.forEach(e=>{e.completed&&t.push(e.id)}),this.deleteCompletedAsync({ctx:this,ids:t})},...Object(r.b)(["getTodosAsync","deleteTodoAsync","addTodoAsync","updateTodoAsync","deleteCompletedAsync"])}}),G=(o(48),Object(u.a)(B,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",{staticClass:"real-app"},[o("input",{staticClass:"add-input",attrs:{type:"text",autofocus:"autofocus",placeholder:"接下来做什么?"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addTodo(e)}}}),t._v(" "),t._l(t.filterTodos,function(e){return o("Item",{key:e.id,attrs:{todo:e},on:{del:t.deleteTodo,toggle:t.toggleTodo}})}),t._v(" "),o("Tabs",{attrs:{filter:t.filter,todos:t.todos},on:{toggle:t.toggleFilter,clearAllCompleted:t.clearAllCompleted}})],2)},[],!1,null,"733600f3",null).exports);var j={metaInfo:{title:"Login Page"},data:()=>({username:"",password:"",errormsg:""}),methods:{loginSubmit(t){t.preventDefault(),this.validate()&&(this.setLoadingVisible(!0),C.login(this.username.trim(),this.password.trim()).then(t=>{setTimeout(()=>{this.setLoadingVisible(!1)},1e3),0===t.data.error?(this.username="",this.password="",this.$router.replace("/todo"),this.$notify({autoCloseTime:3e3,content:"登录成功啦！"})):(this.errormsg=t.data.data.message,this.$notify({autoCloseTime:3e3,content:"用户名或密码错误！"}))}))},validate(){return this.username.trim()?this.password.trim()?(this.errormsg="",!0):(this.errormsg="密码不能为空！",!1):(this.errormsg="用户名不能为空！",!1)},...Object(r.d)({setLoadingVisible:"SET_LOADING_VISIBLE"})}};o(49);const P=[{path:"/",redirect:"/login"},{path:"/todo",component:G},{path:"/login",component:Object(u.a)(j,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("form",{attrs:{id:"login"},on:{submit:t.loginSubmit}},[o("h1",{staticClass:"title"},[o("span",[t._v("Login")]),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:t.errormsg,expression:"errormsg"}],staticClass:"error-msg"},[t._v("\n      "+t._s(t.errormsg)+"\n    ")])]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"login-input",attrs:{type:"text",placeholder:"User Name"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}}),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"login-input",attrs:{type:"password",autocomplete:"new-password",placeholder:"Pass Word"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),t._v(" "),o("button",{staticClass:"login-btn",attrs:{type:"submit"}},[t._v("\n    登 录\n  ")])])},[],!1,null,null,null).exports}],H=new a.a({routes:P,mode:"history"});var q={name:"Notification",props:{content:{type:String,required:!0},btn:{type:String,default:"关闭"}},data:()=>({visible:!1,autoCloseTime:3e3}),computed:{style:()=>({})},mounted(){this.createTimer()},methods:{handleClose(t){t.preventDefault(),this.$emit("close")},createTimer(){this.autoCloseTime&&(this.timer=setTimeout(()=>{this.visible=!1},this.autoCloseTime))},clearTimer(){this.timer&&clearTimeout(this.timer)},afterLeave(){this.$emit("closed",this)},mouseEnterHandler(){this.clearTimer()},mouseLeaveHandler(){this.createTimer()}}},F=(o(50),Object(u.a)(q,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"fade"},on:{"after-leave":t.afterLeave}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"notification",style:t.style,on:{mouseenter:t.mouseEnterHandler,mouseleave:t.mouseLeaveHandler}},[o("span",{staticClass:"content"},[t._v("\n      "+t._s(t.content)+"\n    ")]),t._v(" "),o("a",{staticClass:"btn",on:{click:t.handleClose}},[t._v("\n      "+t._s(t.btn)+"\n    ")])])])},[],!1,null,null,null).exports),U={extends:F,computed:{style(){return{position:"fixed",right:"20px",bottom:`${this.verticalOffset}px`}}},methods:{beforeDestroy(){console.log("beforeDestroy"),this.clearTimer()}},data:()=>({verticalOffset:0})};const J=n.a.extend(U),M=[];let W=1;var R=t=>{if(n.a.prototype.$isServer)return;const{autoCloseTime:e,...o}=t,s=new J({propsData:{...o},data:{autoCloseTime:e}});s.$on("close",()=>{s.visible=!1}),s.$on("closed",t=>{(t=>{if(!t)return;let e=M.findIndex(e=>e.id===t.id);if(M.splice(e,1),t.$destroy(),document.body.removeChild(t.$el),M.length)for(let t=e;t<M.length;t++){let e=M[t];e.verticalOffset-=e.$el.offsetHeight+16}})(t)}),s.visible=!0,s.id=`notification_${W++}`,s.$mount(),document.body.appendChild(s.$el);let i=0;M.forEach(t=>{i+=t.$el.offsetHeight+16}),i+=16,s.verticalOffset=i,M.push(s)},z={name:"Tab"},K=Object(u.a)(z,function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"tab"})},[],!1,null,null,null).exports,Q={name:"Tabs",props:{curIndex:{type:Number,required:!0}}},X=Object(u.a)(Q,void 0,void 0,!1,null,null,null).exports,Y={name:"Loading",props:{loadingVisible:{type:Boolean,default:!1}}},Z=(o(53),Object(u.a)(Y,function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:this.loadingVisible,expression:"loadingVisible"}],attrs:{id:"loading"}},[e("div",{staticClass:"dot-container"},[e("div",{staticClass:"dot dot-1"}),this._v(" "),e("div",{staticClass:"dot dot-2"}),this._v(" "),e("div",{staticClass:"dot dot-3"})])])])},[],!1,null,null,null).exports);o(54);n.a.use(a.a),n.a.use(r.a),n.a.use(d.a),n.a.use(t=>{t.component(F.name,F),t.prototype.$notify=R}),n.a.use(t=>{t.component(K.name,K),t.component(X.name,X)}),n.a.use(t=>{t.component(Z.name,Z)});const{app:tt,router:et,store:ot}=(()=>{const t=(()=>H)(),e=new r.a.Store({state:_,mutations:T,getters:s,actions:i,plugins:[],strict:!1});return{app:new n.a({router:t,store:e,render:t=>t(h)}),router:t,store:e}})();window.__INITIAL_STATE__&&ot.replaceState(window.__INITIAL_STATE__),et.onReady(()=>{tt.$mount("#root")}),window.vm=tt}],[[55,1,2]]]);